<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ ‚Äî Fresh Systems</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap&subset=cyrillic" rel="stylesheet">
<link rel="stylesheet" href="styles.css" />

<style>
/* ==== –õ–û–ö–ê–õ–¨–ù–´–ô –°–¢–ò–õ–¨ –¢–û–õ–¨–ö–û –î–õ–Ø –≠–¢–û–ô –°–¢–†–ê–ù–ò–¶–´ ==== */
:root{
  --ink:#eaf6ff; --muted:#bcd2e7; --cyan:#7dd3fc;
  --panel:rgba(255,255,255,.06); --panel-br:rgba(255,255,255,.12);
}
.page-tech{position:relative; z-index:1; padding-top:84px}
.container{max-width:1200px; margin:0 auto; padding:0 20px}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
.h1{font-weight:900; font-size:clamp(32px,6vw,60px); line-height:1.05; letter-spacing:.2px; color:var(--ink); margin:0 0 8px}
.lead{color:var(--muted); font-size:clamp(14px,2.4vw,18px); margin:0 0 24px}

/* –°–µ–∫—Ü–∏—è —Å —Ç—Ä—É–±–æ–π ‚Äî –æ–¥–Ω–∞ –≤—ã—Å–æ–∫–∞—è ¬´—Å—Ü–µ–Ω–∞¬ª */
.pipe-scene{position:relative; min-height:1800px}
@media (max-width:900px){ .pipe-scene{min-height:2200px} }
@media (max-width:560px){ .pipe-scene{min-height:2400px} }

/* SVG –Ω–∞ –≤—Å—é —Å—Ü–µ–Ω—É */
#pipeSVG{position:absolute; inset:0; width:100%; height:100%; display:block}
.pipe-outer{stroke:rgba(210,240,255,.18); stroke-width:34; fill:none; stroke-linejoin:round; stroke-linecap:round;
  filter:drop-shadow(0 0 8px rgba(125,211,252,.35))}
.pipe-core{stroke:url(#coreGrad); stroke-width:20; fill:none; stroke-linejoin:round; stroke-linecap:round;
  filter:drop-shadow(0 0 10px rgba(116,210,255,.55))}
.flow{stroke:rgba(185,245,255,.95); stroke-width:7; fill:none; stroke-linecap:round; stroke-dasharray:0 24 8 120;
  animation:flow 2.8s linear infinite; opacity:.9; filter:drop-shadow(0 0 6px rgba(116,210,255,.9))}
@keyframes flow{to{stroke-dashoffset:-180}}

/* –ö–∞–ø–ª—è */
.drop{filter:drop-shadow(0 0 12px rgba(116,210,255,.9))}
.drop .b{fill:url(#dropGrad); stroke:#e6fbff; stroke-width:.9}
.drop-glint{fill:#fff; opacity:.9}

/* –ú–æ–¥—É–ª—å-—Ñ–∏–ª—å—Ç—Ä –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º —É—á–∞—Å—Ç–∫–µ */
.module rect{fill:rgba(8,14,24,.86); stroke:rgba(140,200,255,.5); stroke-width:1.6; rx:12; ry:12}
.module .icon{stroke:rgba(214,238,255,.95); stroke-width:2.2; fill:none; stroke-linecap:round; stroke-linejoin:round}

/* –ü–æ–¥–ø–∏—Å–∏-–∫–∞—Ä—Ç–æ—á–∫–∏ —Å–ø—Ä–∞–≤–∞/—Å–ª–µ–≤–∞ */
.note{position:absolute; width:min(440px,42vw); background:var(--panel); border:1px solid var(--panel-br);
  border-radius:16px; padding:14px 16px; backdrop-filter:blur(8px); box-shadow:0 10px 30px rgba(0,0,0,.25)}
.note .tag{display:inline-flex; gap:8px; align-items:center; padding:4px 10px; border-radius:999px;
  border:1px solid rgba(125,211,252,.35); background:rgba(125,211,252,.15); color:#dff6ff; font-weight:700; margin-bottom:6px}
.note h3{margin:6px 0 8px; font-size:18px; color:var(--ink)}
.note p{margin:0; color:#d7e7f4; line-height:1.55; font-size:15px}

/* –ü–ª–∞–≤–Ω—ã–µ –ø–æ—è–≤–ª–µ–Ω–∏—è */
.reveal{opacity:0; transform:translateY(18px); transition:.55s ease}
.reveal.show{opacity:1; transform:none}

/* –ù–∞ –º–æ–±–∏–ª—å–Ω–æ–º –ø–æ–¥–ø–∏—Å–∏ —à–∏—Ä–µ –∏ –Ω–∏–∂–µ —Ç—Ä—É–±—ã */
@media (max-width:820px){
  .note{width:calc(100% - 40px)}
}
</style>
</head>
<body>
<!-- –æ–±—â–∏–π –≤–∏–¥–µ–æ-—Ñ–æ–Ω –∏ –æ–≤–µ—Ä–ª–µ–π —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π -->
<video class="bg-video" autoplay muted loop playsinline poster="images/hero-water.jpg">
  <source src="images/water-bg.mp4" type="video/mp4" />
</video>
<div class="overlay"></div>

<header class="site-header">
  <a class="brand" href="index.html" aria-label="–ù–∞ –≥–ª–∞–≤–Ω—É—é">FS</a>
  <nav class="top-nav" aria-label="–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é">
    <a href="technologies.html" class="active">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</a>
    <a href="sanpin.html">–°–∞–Ω–ü–∏–ù</a>
    <a href="taste.html">–ü–æ—á–µ–º—É –≤–æ–¥–∞ –≤–∫—É—Å–Ω–∞—è</a>
    <a href="services.html">–£—Å–ª—É–≥–∏</a>
    <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
  </nav>
  <button class="menu-toggle" id="menuBtn" aria-label="–ú–µ–Ω—é" aria-expanded="false"><span></span></button>
</header>
<nav class="mobile-drawer" id="drawer" hidden aria-label="–ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é">
  <a href="technologies.html" class="active">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</a>
  <a href="sanpin.html">–°–∞–Ω–ü–∏–ù</a>
  <a href="taste.html">–ü–æ—á–µ–º—É –≤–æ–¥–∞ –≤–∫—É—Å–Ω–∞—è</a>
  <a href="services.html">–£—Å–ª—É–≥–∏</a>
  <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
</nav>

<main class="page-tech container">
  <h1 class="h1">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h1>
  <p class="lead">–ù–∏–∂–µ ‚Äî –Ω–∞–≥–ª—è–¥–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –°–∫—Ä–æ–ª–ª—å ‚Äî –∏ –∫–∞–ø–ª—è –ø—Ä–æ–π–¥—ë—Ç –≤—Å–µ —ç—Ç–∞–ø—ã –ø—É—Ç–∏.</p>

  <!-- —Å—Ü–µ–Ω–∞ —Å –æ–¥–Ω–æ–π –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ç—Ä—É–±–æ–π –∏ –ø–æ–≤–æ—Ä–æ—Ç–∞–º–∏ 90¬∞ -->
  <section class="pipe-scene">
    <svg id="pipeSVG" viewBox="0 0 1200 2000" preserveAspectRatio="none">
      <defs>
        <linearGradient id="coreGrad" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="rgba(230,255,255,.95)"/>
          <stop offset="70%" stop-color="rgba(116,210,255,.65)"/>
          <stop offset="100%" stop-color="rgba(116,210,255,.40)"/>
        </linearGradient>
        <radialGradient id="dropGrad" cx="50%" cy="35%" r="70%">
          <stop offset="0%" stop-color="#ffffff"/>
          <stop offset="60%" stop-color="#eaffff"/>
          <stop offset="100%" stop-color="#7dd3fc"/>
        </radialGradient>
        <!-- –º–∞—Å–∫–∞, —á—Ç–æ–±—ã –∫–∞–ø–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–µ ¬´–≤—ã–ª–µ–∑–∞–ª–∞¬ª –∑–∞ —Ç—Ä—É–±—É -->
        <mask id="tubeMask"><rect x="0" y="0" width="1200" height="2000" fill="black"/>
          <path id="tubeCoreMask" d="" stroke="white" stroke-width="22" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
        </mask>
      </defs>

      <!-- —Ä–µ–∞–ª—å–Ω–∞—è —Ç—Ä—É–±–∞ (–≤–Ω–µ—à–Ω–∏–π + –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–ª–æ–∏) -->
      <path id="tubeOuter" class="pipe-outer" d=""/>
      <path id="tubeCore"  class="pipe-core"  d=""/>
      <path id="tubeFlow"  class="flow"      d="" mask="url(#tubeMask)"/>

      <!-- –º–æ–¥—É–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ (—É–∑–ª—ã) -->
      <g id="modules"></g>

      <!-- –∫–∞–ø–ª—è -->
      <g id="drop" class="drop" transform="translate(0,0)" mask="url(#tubeMask)">
        <ellipse class="b" cx="0" cy="0" rx="11" ry="15"/>
        <circle class="drop-glint" cx="2" cy="-6" r="3"/>
      </g>
    </svg>

    <!-- –ø–æ–¥–ø–∏—Å–∏ –∫ —ç—Ç–∞–ø–∞–º (–∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏) -->
    <div id="notes"></div>
  </section>
</main>

<footer class="site-footer">
  <div class="footer-inner">
    <div class="minor">¬© 2025 Fresh Systems</div>
    <a href="index.html" class="minor">–ì–ª–∞–≤–Ω–∞—è</a>
  </div>
</footer>

<script>
/* ===== –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π ===== */
(function(){
  const btn=document.getElementById('menuBtn'), d=document.getElementById('drawer');
  if(!btn||!d) return;
  const t=o=>{ if(o===undefined) o=!d.classList.contains('open');
    d.classList.toggle('open',o); d.hidden=!o; btn.setAttribute('aria-expanded', String(o));
    document.body.classList.toggle('mobile-menu-open',o); };
  const h=e=>{e.preventDefault(); t();};
  btn.addEventListener('click',h,{passive:false}); btn.addEventListener('touchstart',h,{passive:false});
  document.addEventListener('click',e=>{ if(!d.classList.contains('open')) return;
    if(!d.contains(e.target)&&!btn.contains(e.target)) t(false);});
})();

/* ===== –¥–∞–Ω–Ω—ã–µ —ç—Ç–∞–ø–æ–≤ (–º–µ–∂–¥—É –∏–∑–≥–∏–±–∞–º–∏ –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω —Ñ–∏–ª—å—Ç—Ä) ===== */
const STAGES = [
  {id:'hvs', tag:'–•–í–°',  title:'–í–≤–æ–¥ –•–í–°', text:'–ò—Å—Ö–æ–¥–Ω–∞—è –≤–æ–¥–∞ –Ω–∞ –≤—Ö–æ–¥–µ.'},
  {id:'f1',  tag:'F1',   title:'–ì—Ä—É–±–∞—è –æ—á–∏—Å—Ç–∫–∞ 100 Œºm', text:'–ü–µ—Å–æ–∫, —Ä–∂–∞–≤—á–∏–Ω–∞, –æ–∫–∞–ª–∏–Ω–∞. –ü—Ä–æ–º—ã–≤–Ω–æ–π –±–ª–æ–∫.', icon:'grid'},
  {id:'f2',  tag:'F2',   title:'–¢–æ–Ω–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ 5 Œºm', text:'–ö–∞—Ä—Ç—Ä–∏–¥–∂ PP melt-blown.', icon:'cartridge'},
  {id:'f3',  tag:'F3',   title:'–£–≥–æ–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä', text:'–ê–¥—Å–æ—Ä–±—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∫–∏ –∏ –∑–∞–ø–∞—Ö–æ–≤.', icon:'carbon'},
  {id:'hd',  tag:'HD',   title:'–ù–∞—Å–æ—Å –≤—ã—Å–æ–∫–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è', text:'–î–∞—ë—Ç –Ω–∞–ø–æ—Ä –Ω–∞ —É–∑–µ–ª NF.', icon:'pump'},
  {id:'as',  tag:'AS',   title:'–ê–Ω—Ç–∏—Å–∏–ª–∞–Ω—Ç (–æ–ø—Ü.)', text:'–ó–∞—â–∏—Ç–∞ –º–µ–º–±—Ä–∞–Ω –æ—Ç –æ—Ç–ª–æ–∂–µ–Ω–∏–π.', icon:'dose'},
  {id:'nf',  tag:'NF',   title:'–ù–∞–Ω–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è', text:'–ü–µ—Ä–º–µ–∞—Ç ‚Üí –¥–∞–ª–µ–µ; –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç ‚Üí –¥—Ä–µ–Ω–∞–∂.', icon:'membrane'},
  {id:'min', tag:'MIN',  title:'–ú–∏–Ω–µ—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä Ca/Mg', text:'–§–æ—Ä–º–∏—Ä—É–µ—Ç –≤–∫—É—Å, —Ü–µ–ª–µ–≤–æ–π TDS.', icon:'min'},
  {id:'uv',  tag:'UV',   title:'–£–§-–æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏–µ', text:'–§–∏–Ω–∏—à–Ω–∞—è –±–∏–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.', icon:'uv'},
  {id:'tap', tag:'üíß',   title:'–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å', text:'–ö—Ä–∞–Ω ‚Üí —Å—Ç–∞–∫–∞–Ω —Å —á–∏—Å—Ç–æ–π –≤–æ–¥–æ–π.', icon:'tap', final:true}
];

/* ===== –ì–µ–æ–º–µ—Ç—Ä–∏—è: –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∏–≥–∑–∞–≥–∞ 90¬∞ —Å —É—á—ë—Ç–æ–º —à–∏—Ä–∏–Ω—ã/–≤—ã—Å–æ—Ç—ã ===== */
const svg = document.getElementById('pipeSVG');
const outer = document.getElementById('tubeOuter');
const core  = document.getElementById('tubeCore');
const flow  = document.getElementById('tubeFlow');
const maskCore = document.getElementById('tubeCoreMask');
const mods  = document.getElementById('modules');
const notes = document.getElementById('notes');
const drop  = document.getElementById('drop');

let pathLen = 0, corePath;

function draw(){
  // —Ä–∞–∑–º–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ SVG
  const r = svg.getBoundingClientRect();
  const W = 1200;                // viewBox width
  const H = Math.max(1800, r.height/r.width*1200); // –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞
  svg.setAttribute('viewBox', `0 0 1200 ${H}`);
  // –ø–æ–ª—è –∏ —à–∞–≥–∏
  const padX = 100, padY = 140, segH = (H - padY*2) / (STAGES.length);
  const leftX = padX, rightX = W - padX;

  // —Å—Ç—Ä–æ–∏–º –ø—É—Ç—å: –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤–Ω–∏–∑ –∫ –ø–µ—Ä–≤–æ–º—É –≥–æ—Ä–∏–∑–æ–Ω—Ç—É, –¥–∞–ª–µ–µ ¬´–∑–º–µ–π–∫–æ–π¬ª 90¬∞
  let d = `M ${W/2} ${padY}`;            // —Å—Ç–∞—Ä—Ç –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ —Å–≤–µ—Ä—Ö—É
  d += ` V ${padY + segH*0.5}`;          // –∫ –ø–µ—Ä–≤–æ–º—É –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º—É —É—á–∞—Å—Ç–∫—É

  // –º–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫ —Å–µ—Ä–µ–¥–∏–Ω—ã –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤)
  const midPts = [];

  for(let i=0;i<STAGES.length;i++){
    const y = padY + segH*(i+0.5);
    const dirRight = i%2===0;            // —á—ë—Ç–Ω—ã–µ –≤–ø—Ä–∞–≤–æ, –Ω–µ—á—ë—Ç–Ω—ã–µ –≤–ª–µ–≤–æ
    const x1 = dirRight ? (W/2) : (W/2);
    const x2 = dirRight ? rightX : leftX;
    const xFrom = i===0 ? W/2 : (dirRight ? leftX : rightX); // –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç
    // –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å
    d += ` H ${x2}`;
    midPts.push({x:(xFrom+x2)/2, y, dirRight});
    // –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç, –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
    if(i<STAGES.length-1){
      const yNext = padY + segH*(i+1.0);
      d += ` V ${yNext}`;
      d += ` H ${dirRight ? leftX : rightX}`;
    }
  }

  // —Ñ–∏–Ω–∞–ª: –µ—â—ë –Ω–µ–º–Ω–æ–≥–æ –≤–Ω–∏–∑ –∫ ¬´–∫—Ä–∞–Ω—É/—Å—Ç–∞–∫–∞–Ω—É¬ª
  d += ` V ${H - padY}`;

  outer.setAttribute('d', d);
  core.setAttribute('d', d);
  flow.setAttribute('d', d);
  maskCore.setAttribute('d', d);
  corePath = core;                // –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–ø–ª–∏
  pathLen = corePath.getTotalLength();

  // –æ—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –º–æ–¥—É–ª–∏/–ø–æ–¥–ø–∏—Å–∏
  mods.innerHTML=''; notes.innerHTML='';
  const gap = 160; // –æ—Ç—Å—Ç—É–ø –∫–∞—Ä—Ç–æ—á–µ–∫ –æ—Ç –∫—Ä–∞—è —Ç—Ä—É–±—ã

  STAGES.forEach((s,i)=>{
    // –º–æ–¥—É–ª—å (–∏–∫–æ–Ω–∫–∞) –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–µ–≥–º–µ–Ω—Ç–∞
    const m = midPts[i];
    const g = document.createElementNS('http://www.w3.org/2000/svg','g');
    g.setAttribute('class','module');
    g.setAttribute('transform', `translate(${m.x},${m.y})`);
    g.innerHTML = moduleIcon(s.icon);
    mods.appendChild(g);

    // –ø–æ–¥–ø–∏—Å—å ‚Äî —Å–ø—Ä–∞–≤–∞ –∏–ª–∏ —Å–ª–µ–≤–∞ (—á–µ—Ä–µ–¥—É–µ–º)
    const div = document.createElement('div');
    div.className = 'note reveal';
    div.innerHTML = `
      <div class="tag">${s.tag}${s.id==='as'?' ¬∑ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ':''}</div>
      <h3>${s.title}</h3>
      <p>${s.text}</p>
    `;
    notes.appendChild(div);

    // –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
    const toRight = m.dirRight; // –µ—Å–ª–∏ —Ç—Ä—É–±–∞ –∏–¥—ë—Ç –≤–ø—Ä–∞–≤–æ ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ —Å–ø—Ä–∞–≤–∞
    const left = toRight ? (svg.clientWidth - 20 - Math.min(440, window.innerWidth-40)) : 20;
    div.style.left = left+'px';
    // —á—É—Ç—å –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–∏, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å
    const sceneTop = svg.getBoundingClientRect().top + window.scrollY;
    const noteY = sceneTop + (m.y - 70);
    div.style.top = noteY+'px';
  });

  // ¬´—Å–≤–µ—á–∞—â–∞—è—Å—è¬ª —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è –∫–∞–ø–ª–∏ ‚Äî –≤ –Ω–∞—á–∞–ª–µ
  moveDrop(0);
}

function moduleIcon(kind){
  const box = `<rect x="-72" y="-24" width="144" height="48"/>`;
  switch(kind){
    case 'grid':      return `${box}<path class="icon" d="M-50 -14 h100 v28 h-100 z M-30 -14 v28 M30 -14 v28"/>`;
    case 'cartridge': return `${box}<ellipse class="icon" cx="0" cy="0" rx="36" ry="16"/>`;
    case 'carbon':    return `${box}<path class="icon" d="M-46 -8 h92 v16 h-92 z M-40 -12 h80 M-40 12 h80"/>`;
    case 'pump':      return `${box}<path class="icon" d="M-40 -10 h40 v20 h-40 z M6 -8 h20 v16 h-20 z"/>`;
    case 'dose':      return `${box}<path class="icon" d="M-12 -18 v36 M12 -18 v36 M-22 0 h44"/>`;
    case 'membrane':  return `${box}<path class="icon" d="M-50 -10 h100 v20 h-100 z M-40 -6 h80 v12 h-80 z"/>`;
    case 'min':       return `${box}<path class="icon" d="M-28 -18 h56 v36 h-56 z M-12 -6 h24 v18 h-24 z"/>`;
    case 'uv':        return `${box}<path class="icon" d="M-40 0 h80 M-22 -10 h44 M-22 10 h44"/>`;
    case 'tap':       return `${box}<path class="icon" d="M-24 0 h48 M16 0 v16 M0 18 v-8"/>`;
    default:          return `${box}<path class="icon" d="M-20 -12 h40 v24 h-40 z"/>`;
  }
}

/* ===== –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–ø–ª–∏ –ø–æ —Å–∫—Ä–æ–ª–ª—É (–≤–ø–µ—Ä—ë–¥/–Ω–∞–∑–∞–¥) ===== */
function moveDrop(progress){ // 0..1
  const L = pathLen * Math.min(1, Math.max(0, progress));
  const pt = corePath.getPointAtLength(L || 0.0001);
  drop.setAttribute('transform', `translate(${pt.x},${pt.y})`);
}
function onScroll(){
  const scene = document.querySelector('.pipe-scene');
  const rect = scene.getBoundingClientRect();
  const vh = window.innerHeight;
  // –ø—Ä–æ–≥—Ä–µ—Å—Å: –¥–æ–ª—è ¬´–ø—Ä–æ–ª–∏—Å—Ç–∞–Ω–Ω–æ–π¬ª —Å—Ü–µ–Ω—ã –≤ –∑–æ–Ω–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏
  const total = rect.height + vh;
  const gone  = Math.min(total, Math.max(0, vh - rect.top));
  const p = gone / total;
  moveDrop(p);

  // –≤–∫–ª—é—á–∞–µ–º –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
  document.querySelectorAll('.note').forEach(n=>{
    const nr = n.getBoundingClientRect();
    if(nr.top < vh*0.8) n.classList.add('show');
  });
}
addEventListener('scroll', onScroll, {passive:true});
addEventListener('resize', ()=>{ draw(); onScroll(); });

draw(); onScroll();
</script>
</body>
</html>
