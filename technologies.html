<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ ‚Äî Fresh Systems</title>
<meta name="color-scheme" content="dark" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap&subset=cyrillic" rel="stylesheet">
<link rel="stylesheet" href="styles.css" />
<link rel="preload" as="video" href="images/water-bg.mp4" type="video/mp4">
<link rel="preload" as="image" href="images/hero-water.jpg">

<style>
/* ‚Äî‚Äî‚Äî –õ–û–ö–ê–õ–¨–ù–´–ï –ê–ö–¶–ï–ù–¢–´ –°–¢–†–ê–ù–ò–¶–´ ‚Äî‚Äî‚Äî */
:root{
  --glass: rgba(160,230,255,.20);
  --panel-bg: rgba(255,255,255,.055);
  --panel-br: rgba(255,255,255,.10);
  --cyan:#7dd3fc;
}

/* —Ñ–æ–Ω-–≤–∏–¥–µ–æ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –∏–∑ styles.css; –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö ‚Äî –ø–æ—Å—Ç–µ—Ä */
body.no-video .bg-video{display:none}

/* —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç—Ä—É–±–∞: –≤—Å–µ–≥–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ */
.pipe-overlay{
  position:fixed; inset:0; z-index:1; pointer-events:none;
  /* —á—É—Ç—å –Ω–∞–¥ –≤–æ–¥–Ω—ã–º –≤–∏–¥–µ–æ –∏ –ø–æ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º */
}
.overlay-svg{width:100%; height:100%; display:block}

/* —Å—Ç–µ–∫–ª—è–Ω–Ω–∞—è —Ç—Ä—É–±–∞ */
#olPath{
  stroke: rgba(220,245,255,.18); stroke-width:24; fill:none;
  stroke-linecap:round; stroke-linejoin:round;
  filter: drop-shadow(0 0 12px rgba(125,211,252,.28));
}
#olCore{
  stroke: url(#coreGrad); stroke-width:13; fill:none;
  stroke-linecap:round; stroke-linejoin:round;
  filter: blur(.2px) drop-shadow(0 0 10px rgba(125,211,252,.45));
}

/* –∫–∞–ø–ª—è */
#olDrop{ filter: drop-shadow(0 0 10px rgba(116,210,255,.9)); }
#olDrop .body{
  fill:url(#dropGrad); stroke:#e6fbff; stroke-width:.8;
}

/* –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–π —Å–ª–æ–π –ø–æ–≤–µ—Ä—Ö —Ç—Ä—É–±—ã */
.pipe-page{ position:relative; z-index:2; padding-top:56px }
.container-narrow{ max-width:1100px; margin:0 auto; padding:0 18px }

/* —Å–µ—Ç–∫–∞: —Å–ª–µ–≤–∞ –º–∏–Ω–∏-–∫–∞—Ä—Ç–∞, —Å–ø—Ä–∞–≤–∞ –ø–∞–Ω–µ–ª—å–∫–∏-—É–∑–ª—ã */
.pipe-grid{ display:grid; grid-template-columns: 250px 1fr; gap:22px }
@media (max-width:1024px){ .pipe-grid{ grid-template-columns:1fr } }

/* –º–∏–Ω–∏-–∫–∞—Ä—Ç–∞ */
.toc{
  position:sticky; top:88px; align-self:flex-start;
  background:var(--panel-bg); border:1px solid var(--panel-br);
  border-radius:14px; padding:12px; backdrop-filter: blur(8px);
}
.toc h3{ margin:4px 0 8px; font-size:13px; color:#a9defc; letter-spacing:.08em; text-transform:uppercase }
.toc a{ display:flex; gap:8px; align-items:center; padding:8px 10px; border-radius:10px; color:#e6f3ff; font-weight:600; text-decoration:none }
.toc a .dot{ width:8px; height:8px; border-radius:50%; background:var(--cyan); box-shadow:0 0 8px var(--cyan) }
.toc a.active{ background:rgba(56,189,248,.14) }
.toc .hint{ margin-top:6px; color:#97a6b8; font-size:12px }

/* –º–æ–±. —à—Ç–æ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞–¥–∏–π */
.toc-toggle{ display:none }
@media (max-width:1024px){ .toc{display:none} .toc-toggle{display:inline-flex;margin-top:10px} }
.toc-sheet{
  position:fixed; left:16px; right:16px; bottom:16px; max-height:60vh; overflow:auto;
  background:rgba(11,16,32,.96); border:1px solid var(--panel-br); border-radius:16px; padding:12px;
  display:none; z-index:50; backdrop-filter: blur(8px);
}
.toc-sheet.open{ display:block }

/* –ø–∞–Ω–µ–ª–∏-—É–∑–ª—ã */
.node{ margin:90vh 0 } /* –∫—Ä—É–ø–Ω—ã–µ —Å–µ–∫—Ü–∏–∏: –∫–∞–∂–¥–∞—è ¬´–ø—Ä–æ–ª–∞–º—ã–≤–∞–µ—Ç—Å—è¬ª —Ç—Ä—É–±–æ–π */
.node-inner{
  max-width:620px;
  background:var(--panel-bg); border:1px solid var(--panel-br);
  border-radius:16px; padding:14px; backdrop-filter: blur(8px);
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
.node .tag{
  display:inline-flex; align-items:center; gap:8px;
  background:rgba(56,189,248,.14); color:#cfefff; border:1px solid rgba(56,189,248,.28);
  padding:4px 10px; border-radius:999px; font-weight:700; letter-spacing:.03em; margin-bottom:6px;
}
.node h3{ margin:4px 0 6px; font-size:20px }
.node p{ margin:0; color:#dbe9f6; font-size:15px; line-height:1.55 }
.node details{ margin-top:8px }
.node summary{ cursor:pointer; list-style:none; color:#cfe9f8; font-weight:600 }
.node summary::marker, .node summary::-webkit-details-marker{ display:none }
.node .tech{
  margin-top:8px; border:1px dashed rgba(125,211,252,.35);
  border-radius:12px; padding:10px 12px; color:#d7e7f4; font-size:14px;
  background:rgba(125,211,252,.06);
}

/* 3D-–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏ (–ª—ë–≥–∫–∏–µ ¬´—à–∞—Ä–∂–∏¬ª) */
.illus{ height:70px; margin-bottom:8px; display:flex; align-items:center; gap:10px }
.cyl{
  width:68px; height:40px; border-radius:28px/16px;
  background: linear-gradient(180deg,#dfe5ea,#a8b5c5 60%,#7f8ca0);
  box-shadow: inset 0 2px 8px rgba(0,0,0,.25), 0 6px 14px rgba(0,0,0,.25);
}
.pump{
  width:62px; height:38px; border-radius:8px;
  background: linear-gradient(180deg,#b7c7d8,#7f8ea5);
  box-shadow: inset 0 2px 8px rgba(0,0,0,.25), 0 6px 14px rgba(0,0,0,.25);
  position:relative;
}
.pump::after{
  content:""; position:absolute; right:-14px; top:8px; width:14px; height:20px; border-radius:6px;
  background: linear-gradient(180deg,#e2edf6,#94a7bc);
}

/* —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞–∫–∞–Ω ‚Äî –æ—Å—Ç–∞—ë—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ–∫—Ü–∏–∏ */
.glass{
  width:56px;height:78px;border-radius:8px;margin:12px 0 0;
  border:2px solid rgba(200,230,255,.7);
  background:linear-gradient(180deg,rgba(160,230,255,.10),rgba(160,230,255,.16));
  position:relative; overflow:hidden;
}
.fill{ position:absolute; left:0; right:0; bottom:0; height:0%;
  background:linear-gradient(180deg,rgba(116,210,255,.5),rgba(116,210,255,.9)); transition:height .6s ease }
.taste{
  position:absolute; inset:-30px; border-radius:16px; pointer-events:none; opacity:0;
  background:radial-gradient(60px 30px at 50% 60%, rgba(124,249,210,.35), rgba(117,210,255,.00) 60%),
             radial-gradient(40px 24px at 30% 50%, rgba(181,255,122,.30), rgba(117,210,255,.00) 60%),
             radial-gradient(40px 24px at 70% 40%, rgba(181,255,122,.20), rgba(117,210,255,.00) 60%);
  filter: blur(10px); transition: opacity .8s ease;
}

/* –ø–ª–∞–≤–Ω—ã–µ –ø–æ—è–≤–ª–µ–Ω–∏—è */
.reveal{opacity:0; transform:translateY(18px); transition:.5s ease}
.reveal.show{opacity:1; transform:none}

/* –ª–∏–Ω–∫ –±–µ–∑ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è */
a{text-decoration:none}
</style>
</head>
<body class="no-video">

<!-- —Ñ–æ–Ω –∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π -->
<video id="bgVideo" class="bg-video" autoplay muted loop playsinline preload="auto" poster="images/hero-water.jpg">
  <source src="images/water-bg.mp4" type="video/mp4" />
</video>
<div class="overlay"></div>

<!-- —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç—Ä—É–±–∞ + –∫–∞–ø–ª—è -->
<div class="pipe-overlay" aria-hidden="true">
  <svg class="overlay-svg" id="ol" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice">
    <defs>
      <linearGradient id="coreGrad" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="rgba(220,255,255,.95)"/>
        <stop offset="70%" stop-color="rgba(116,210,255,.65)"/>
        <stop offset="100%" stop-color="rgba(116,210,255,.40)"/>
      </linearGradient>
      <radialGradient id="dropGrad" cx="50%" cy="35%" r="70%">
        <stop offset="0%" stop-color="#ffffff"/>
        <stop offset="60%" stop-color="#cfffff"/>
        <stop offset="100%" stop-color="#7dd3fc"/>
      </radialGradient>
    </defs>

    <!-- –ó–∏–≥–∑–∞–≥ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 1 —ç–∫—Ä–∞–Ω–∞ (—Ç—Ä—É–±–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞) -->
    <path id="olPath" d="
      M 120 120
      C 420 120, 780 140, 1080 220
      S 780 380, 420 460
      S 120 620, 540 700
    "/>
    <path id="olCore" d="
      M 120 120
      C 420 120, 780 140, 1080 220
      S 780 380, 420 460
      S 120 620, 540 700
    "/>

    <!-- –°–≤–µ—Ç—è—â–∞—è—Å—è –∫–∞–ø–ª—è (–¥–≤–∏–≥–∞–µ–º –ø–æ –ø—É—Ç–∏ —Å–∫—Ä–æ–ª–ª–æ–º) -->
    <g id="olDrop" transform="translate(120,120)">
      <ellipse class="body" cx="0" cy="0" rx="11" ry="15"/>
      <circle cx="2" cy="-6" r="3" fill="#fff" opacity=".85"/>
    </g>
  </svg>
</div>

<header class="site-header">
  <a class="brand" href="index.html" aria-label="–ù–∞ –≥–ª–∞–≤–Ω—É—é">FS</a>
  <nav class="top-nav" aria-label="–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é">
    <a href="technologies.html" class="active">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</a>
    <a href="sanpin.html">–°–∞–Ω–ü–∏–ù</a>
    <a href="taste.html">–ü–æ—á–µ–º—É –≤–æ–¥–∞ –≤–∫—É—Å–Ω–∞—è</a>
    <a href="services.html">–£—Å–ª—É–≥–∏</a>
    <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
  </nav>
  <button class="menu-toggle" id="menuBtn" aria-label="–ú–µ–Ω—é" aria-expanded="false"><span></span></button>
</header>
<nav class="mobile-drawer" id="drawer" hidden aria-label="–ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é">
  <a href="technologies.html" class="active">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</a>
  <a href="sanpin.html">–°–∞–Ω–ü–∏–ù</a>
  <a href="taste.html">–ü–æ—á–µ–º—É –≤–æ–¥–∞ –≤–∫—É—Å–Ω–∞—è</a>
  <a href="services.html">–£—Å–ª—É–≥–∏</a>
  <a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
</nav>

<section class="pipe-page">
  <div class="container-narrow">
    <h1 class="h1">–ü—É—Ç—å –≤–æ–¥—ã: –æ—Ç –•–í–° –¥–æ —Å—Ç–∞–∫–∞–Ω–∞</h1>
    <p class="sub">–ö–∞–ø–ª—è –¥–≤–∏–≥–∞–µ—Ç—Å—è –ø–æ ¬´—Å—Ç–µ–∫–ª—è–Ω–Ω–æ–π —Ç—Ä—É–±–µ¬ª —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º. –£–∑–ª—ã ‚Äî —Å–ø—Ä–∞–≤–∞, —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ ¬´–ü–æ–¥—Ä–æ–±–Ω–µ–µ¬ª.</p>
    <button class="btn ghost toc-toggle" id="tocBtn">–°–ø–∏—Å–æ–∫ —Å—Ç–∞–¥–∏–π</button>
  </div>

  <div class="container-narrow pipe-grid">
    <!-- –º–∏–Ω–∏-–∫–∞—Ä—Ç–∞ -->
    <aside class="toc" id="tocDesk">
      <h3>–°—Ç–∞–¥–∏–∏</h3>
      <nav id="tocNav"></nav>
      <div class="hint">–ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫–∞–ø–ª–µ–π</div>
    </aside>

    <!-- —à—Ç–æ—Ä–∫–∞ –¥–ª—è –º–æ–±–∏–ª—ã -->
    <div class="toc-sheet" id="tocSheet">
      <div class="toc" style="position:static"><h3>–°—Ç–∞–¥–∏–∏</h3><nav id="tocNavMobile"></nav></div>
    </div>

    <!-- —É–∑–ª—ã (–∫–æ–Ω—Ç–µ–Ω—Ç) -->
    <div id="nodes"></div>
  </div>
</section>

<footer class="site-footer">
  <div class="footer-inner">
    <div class="minor">¬© 2025 Fresh Systems</div>
    <a href="index.html" class="minor">–ì–ª–∞–≤–Ω–∞—è</a>
  </div>
</footer>

<script>
/* ‚Äî —Ñ–æ–Ω-–≤–∏–¥–µ–æ –±–µ—Ä–µ–∂–Ω–æ –¥–ª—è –º–æ–±–∏–ª—ã ‚Äî */
(function(){
  const isMobile = matchMedia('(max-width: 768px)').matches;
  const v = document.getElementById('bgVideo');
  if(!v) return;
  const ok=()=>{ document.body.classList.remove('no-video'); v.play?.().catch(()=>{}); };
  if(isMobile){
    document.body.classList.add('mobile-bg');
    v.pause?.(); v.removeAttribute('src'); v.load();
  }else{
    v.addEventListener('loadeddata', ok, {once:true});
    v.addEventListener('canplay', ok, {once:true});
    setTimeout(()=>{ if(v.readyState>=2) ok(); }, 1500);
  }
})();

/* ‚Äî –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é (–∫–ª–∏–∫ + —Ç–∞—á) ‚Äî */
(function(){
  const btn = document.getElementById('menuBtn');
  const drawer = document.getElementById('drawer');
  if(!btn || !drawer) return;
  const toggle=(open)=>{
    if(open===undefined) open=!drawer.classList.contains('open');
    drawer.classList.toggle('open', open);
    drawer.hidden=!open;
    btn.setAttribute('aria-expanded', String(open));
    document.body.classList.toggle('mobile-menu-open', open);
  };
  const h=(e)=>{ e.preventDefault(); toggle(); };
  btn.addEventListener('click',h,{passive:false});
  btn.addEventListener('touchstart',h,{passive:false});
  const closeOutside=(e)=>{
    if(!drawer.classList.contains('open')) return;
    if(!drawer.contains(e.target) && !btn.contains(e.target)) toggle(false);
  };
  document.addEventListener('click',closeOutside);
  document.addEventListener('touchstart',closeOutside,{passive:true});
})();

/* ‚Äî –∫–æ–Ω—Ñ–∏–≥ —Å—Ç–∞–¥–∏–π ‚Äî */
const NODES = [
  { id:'hvs',  tag:'–•–í–°',  title:'–í–≤–æ–¥ –•–í–°', text:'–ò—Å—Ö–æ–¥–Ω–∞—è –≤–æ–¥–∞ –Ω–∞ –≤—Ö–æ–¥–µ.', tech:['–ü–∏—Ç—å–µ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ç—Ä—É–±','–ë–∞–π–ø–∞—Å/–æ—Ç—Å–µ—á–∫–∏'] },
  { id:'k1',   tag:'K1',   title:'–û—Ç—Å–µ—á–Ω–æ–π –∫—Ä–∞–Ω', text:'–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —É–∑–ª–∞.', tech:['–ü–æ–ª–Ω–æ–æ—Ç–∫—Ä—ã—Ç—ã–π –ø—Ä–æ—Ö–æ–¥'] },
  { id:'ok',   tag:'OK',   title:'–û–±—Ä–∞—Ç–Ω—ã–π –∫–ª–∞–ø–∞–Ω', text:'–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ç–æ–∫.', tech:['–ü–æ–¥–±–æ—Ä –ø–æ —Ä–∞—Å—Ö–æ–¥—É –∏ ŒîP'] },
  { id:'f1',   tag:'F1',   title:'–ì—Ä—É–±–∞—è –æ—á–∏—Å—Ç–∫–∞ 100 Œºm', text:'–ü–µ—Å–æ–∫, –æ–∫–∞–ª–∏–Ω–∞, —Ä–∂–∞–≤—á–∏–Ω–∞.', tech:['–ü—Ä–æ–º—ã–≤–∫–∏ –ø–æ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É'], drain:true },
  { id:'f2',   tag:'F2',   title:'–¢–æ–Ω–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ 5 Œºm', text:'–ë–∞–∑–æ–≤–∞—è —Å—Ç—É–ø–µ–Ω—å PP melt-blown.', tech:['–ó–∞–º–µ–Ω–∞ –ø–æ ŒîP/—Å—Ä–æ–∫—É'] },
  { id:'f3',   tag:'F3',   title:'–£–≥–æ–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä', text:'–ê–¥—Å–æ—Ä–±—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∫–∏, –∑–∞–ø–∞—Ö–æ–≤.', tech:['–î–ª—è –∑–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ ‚Äî –ø—Ä–æ–º—ã–≤–∫–∏'], drain:true },
  { id:'hd',   tag:'HD',   title:'–ù–∞—Å–æ—Å –≤—ã—Å–æ–∫–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è', text:'–°–æ–∑–¥–∞—ë—Ç –Ω–∞–ø–æ—Ä –¥–ª—è NF.', tech:['–£–≤—è–∑–∫–∞ —Ä–∞—Å—Ö–æ–¥/–Ω–∞–ø–æ—Ä','–®—É–º–æ/–≤–∏–±—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è'], type:'pump' },
  { id:'as',   tag:'AS',   title:'–î–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω—Ç–∏—Å–∏–ª–∞–Ω—Ç–∞ (–æ–ø—Ü.)', text:'–ó–∞—â–∏—Ç–∞ –º–µ–º–±—Ä–∞–Ω –æ—Ç –æ—Ç–ª–æ–∂–µ–Ω–∏–π.', tech:['–î–æ–∑–∞ –ø–æ –∞–Ω–∞–ª–∏–∑—É –≤–æ–¥—ã'], optional:true },
  { id:'nf',   tag:'NF',   title:'–ù–∞–Ω–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è', text:'–ü–µ—Ä–º–µ–∞—Ç ‚Üí –¥–∞–ª–µ–µ; –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç ‚Üí –¥—Ä–µ–Ω–∞–∂.', tech:['–ö–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç–∏','–í–æ–∑–¥—É—à–Ω—ã–π –∑–∞–∑–æ—Ä –Ω–∞ —Å–ª–∏–≤–µ'], drain:true },
  { id:'min',  tag:'MIN',  title:'–ú–∏–Ω–µ—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä Ca/Mg', text:'–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∫—É—Å–∞ –∏ TDS.', tech:['–ö–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–≥—Ä—É–∑–∫–∏; —Ü–µ–ª–µ–≤–æ–π TDS'] },
  { id:'uv',   tag:'UV',   title:'–£–§-–æ–±–µ–∑–∑–∞—Ä–∞–∂–∏–≤–∞–Ω–∏–µ', text:'–§–∏–Ω–∏—à–Ω–∞—è –±–∏–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.', tech:['–ó–∞–º–µ–Ω–∞ –ª–∞–º–ø—ã; —á–∏—Å—Ç–∫–∞ –∫–≤–∞—Ä—Ü–∞'] },
  { id:'tank', tag:'–ë–ê–ö',  title:'–ë–∞–∫ —á–∏—Å—Ç–æ–π –≤–æ–¥—ã', text:'–†–µ–∑–µ—Ä–≤ –∏ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –ø–∏–∫–æ–≤.', tech:['–û–±—ä—ë–º –ø–æ –ø–∏–∫–∞–º –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è'] },
  { id:'pump', tag:'PUMP', title:'–ù–∞—Å–æ—Å –ø–æ–¥–∞—á–∏', text:'–ü–æ–¥–∞—á–∞ –≤ –ø–∏—Ç—å–µ–≤—ã–µ —Å—Ç–æ—è–∫–∏.', tech:['–î–∞–≤–ª–µ–Ω–∏–µ/—Ä–∞—Å—Ö–æ–¥ –ø–æ–¥ —Å–µ—Ç—å'] },
  { id:'tap',  tag:'üíß',   title:'–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å', text:'–ö—É—Ö–Ω–∏, —Ñ–æ–Ω—Ç–∞–Ω—á–∏–∫–∏ ‚Äî —á–∏—Å—Ç–∞—è –≤–æ–¥–∞.', tech:['–°–º. ¬´–ü–æ—á–µ–º—É –≤–æ–¥–∞ –≤–∫—É—Å–Ω–∞—è¬ª'], final:true },
];

/* ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–∑–ª–æ–≤ –∏ –º–∏–Ω–∏-–∫–∞—Ä—Ç—ã ‚Äî */
(function build(){
  const nodesWrap = document.getElementById('nodes');
  const toc = document.getElementById('tocNav');
  const tocM = document.getElementById('tocNavMobile');

  NODES.forEach((n,idx)=>{
    const node = document.createElement('section');
    node.className='node reveal';
    node.id = 'node-'+n.id;

    const ill = (n.type==='pump')
      ? '<div class="pump" aria-hidden="true"></div>'
      : '<div class="cyl" aria-hidden="true"></div>';

    node.innerHTML = `
      <div class="node-inner">
        <span class="tag">${n.tag}${n.optional?' ¬∑ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ':''}</span>
        <div class="illus">${ill}<h3 style="margin:0 0 0 6px">${n.title}</h3></div>
        <p>${n.text}</p>
        ${n.drain?'<p style="color:#9fdfff;margin-top:6px">–û—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏–µ: –î—Ä–µ–Ω–∞–∂ ‚Üí –≤–æ—Ä–æ–Ω–∫–∞ (–≤–æ–∑–¥. –∑–∞–∑–æ—Ä) ‚Üí –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è</p>':''}
        ${n.final?`
          <div style="display:flex;align-items:flex-end; gap:18px; margin-top:10px">
            <div style="width:70px;height:54px;border-radius:10px;background:linear-gradient(180deg,#dbe6f0,#9fb0c4);box-shadow:inset 0 2px 8px rgba(0,0,0,.25)"></div>
            <div class="glass"><div class="fill" id="fill"></div><div class="taste" id="taste"></div></div>
          </div>
        `:''}
        <details><summary>–ü–æ–¥—Ä–æ–±–Ω–µ–µ</summary>
          <div class="tech"><strong>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏:</strong><ul style="margin:6px 0 0 18px">${n.tech.map(t=>`<li>${t}</li>`).join('')}</ul></div>
        </details>
      </div>`;
    nodesWrap.appendChild(node);

    const a = document.createElement('a');
    a.href = '#node-'+n.id;
    a.innerHTML = `<span class="dot"></span> ${n.tag} ${n.title}`;
    toc?.appendChild(a.cloneNode(true));
    tocM?.appendChild(a);
  });
})();

/* ‚Äî –∫–∞–ø–ª—è –¥–≤–∏–≥–∞–µ—Ç—Å—è –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ ‚Äî */
(function droplet(){
  const path = document.getElementById('olPath');
  const drop = document.getElementById('olDrop');
  if(!path || !drop) return;

  const total = path.getTotalLength();
  const fill = document.getElementById('fill');
  const taste = document.getElementById('taste');

  const tocLinks = Array.from(document.querySelectorAll('#tocNav a, #tocNavMobile a'));
  const sections = Array.from(document.querySelectorAll('.node'));

  let ticking=false;
  const getScrollProgress=()=>{
    const doc = document.documentElement;
    const scrollTop = doc.scrollTop || document.body.scrollTop;
    const docH = doc.scrollHeight - window.innerHeight;
    return docH>0 ? Math.min(1, Math.max(0, scrollTop / docH)) : 0;
  };

  const update=()=>{
    const p = getScrollProgress();
    const len = p*(total-6);
    const pt = path.getPointAtLength(len);
    drop.setAttribute('transform',`translate(${pt.x},${pt.y})`);

    // –∞–∫—Ç–∏–≤ –≤ –º–∏–Ω–∏-–∫–∞—Ä—Ç–µ
    let active = 0;
    for(let i=0;i<sections.length;i++){
      const r = sections[i].getBoundingClientRect();
      if(r.top < innerHeight*0.45) active = i;
    }
    const id = '#'+sections[active].id;
    tocLinks.forEach(a=>a.classList.toggle('active', a.getAttribute('href')===id));

    // —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –≤–∫—É—Å
    if(fill && taste){
      const last = sections[sections.length-1].getBoundingClientRect();
      const vh = innerHeight;
      const f = 1 - Math.min(1, Math.max(0, last.top/vh));
      fill.style.height = (f*100)+'%';
      taste.style.opacity = f>0.95 ? 1 : 0;
    }

    // –ø–æ—è–≤–ª–µ–Ω–∏—è
    sections.forEach(s=>{
      if(s.classList.contains('show')) return;
      const r = s.getBoundingClientRect();
      if(r.top < innerHeight*0.8) s.classList.add('show');
    });

    ticking=false;
  };

  const onScroll=()=>{ if(!ticking){ ticking=true; requestAnimationFrame(update); } };
  window.addEventListener('scroll', onScroll, {passive:true});
  window.addEventListener('resize', onScroll, {passive:true});
  update();
})();

/* ‚Äî –∫–ª–∏–∫–∏ –ø–æ –º–∏–Ω–∏-–∫–∞—Ä—Ç–µ ‚Äî */
document.getElementById('tocDesk')?.addEventListener('click', (e)=>{
  const a = e.target.closest('a'); if(!a) return;
  e.preventDefault(); document.querySelector(a.getAttribute('href'))?.scrollIntoView({behavior:'smooth', block:'center'});
});
document.getElementById('tocSheet')?.addEventListener('click', (e)=>{
  const a = e.target.closest('a'); if(!a) return;
  e.preventDefault(); document.querySelector(a.getAttribute('href'))?.scrollIntoView({behavior:'smooth', block:'center'});
  document.getElementById('tocSheet').classList.remove('open');
});
document.getElementById('tocBtn')?.addEventListener('click', ()=> document.getElementById('tocSheet').classList.toggle('open'));
</script>
</body>
</html>
