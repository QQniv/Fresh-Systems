<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Технологии — Fresh Systems</title>
<meta name="color-scheme" content="dark" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap&subset=cyrillic" rel="stylesheet">
<link rel="stylesheet" href="styles.css" />
<link rel="preload" as="image" href="images/hero-water.jpg">
<link rel="preload" as="video" href="images/water-bg.mp4" type="video/mp4">

<style>
/* --- ЛОКАЛЬНЫЙ СТИЛЬ СТРАНИЦЫ (не ломает другие) --- */
:root{
  --glass: rgba(160,230,255,.20);
  --glass2: rgba(125,211,252,.18);
  --cyan: #7dd3fc;
  --cyan-strong:#74d2ff;
  --mint:#7cf9d2;
  --lime:#b5ff7a;
  --panel-bg: rgba(255,255,255,.055);
  --panel-br: rgba(255,255,255,.10);
}
body.no-video .bg-video{display:none}

/* шапка такая же, подключается из styles.css */

/* контейнер */
.pipe-page{padding-top:56px}
.container-narrow{max-width:1100px;margin:0 auto;padding:0 18px}

/* мини-карта */
.toc{
  position:sticky; top:88px; align-self:flex-start;
  background:var(--panel-bg); border:1px solid var(--panel-br);
  border-radius:14px; padding:12px; backdrop-filter: blur(8px);
}
.toc h3{margin:4px 0 8px 0; font-size:13px; color:#9ed8f7; letter-spacing:.08em; text-transform:uppercase}
.toc a{
  display:flex; gap:8px; align-items:center; padding:8px 10px; border-radius:10px;
  color:#d7eaf8; font-weight:600;
}
.toc a .dot{width:8px;height:8px;border-radius:50%;background:var(--cyan);box-shadow:0 0 8px var(--cyan)}
.toc a.active{background:rgba(56,189,248,.14)}
.toc .hint{margin-top:6px;color:#93a4b8;font-size:12px}

/* моб. кнопка списка стадий */
.toc-toggle{display:none}
@media (max-width:1024px){ .toc{display:none} .toc-toggle{display:inline-flex;margin-top:10px} }
.toc-sheet{
  position:fixed; left:16px; right:16px; bottom:16px; max-height:60vh; overflow:auto;
  background:rgba(11,16,32,.96); border:1px solid var(--panel-br); border-radius:16px; padding:12px;
  display:none; z-index:50; backdrop-filter: blur(8px);
}
.toc-sheet.open{display:block}

/* сетка страницы */
.pipe-grid{display:grid; grid-template-columns: 250px 1fr; gap:20px}
@media (max-width:1024px){ .pipe-grid{grid-template-columns:1fr} }

/* --- SVG-сцена трубы --- */
.scene-wrap{position:relative}
.svg-scene{
  width:100%; height:4200px; /* высота всей “дороги” */
  display:block;
}

/* стеклянная труба: два штриха + свечение */
#pipePath{
  stroke: rgba(210,240,255,.18);
  stroke-width:26; fill:none; stroke-linecap:round; stroke-linejoin:round;
  filter: drop-shadow(0 0 10px rgba(125,211,252,.25));
}
#pipeCore{
  stroke: url(#coreGrad);
  stroke-width:14; fill:none; stroke-linecap:round; stroke-linejoin:round;
  filter: blur(.2px) drop-shadow(0 0 8px rgba(125,211,252,.45));
}

/* капля */
#drop{
  filter: drop-shadow(0 0 10px rgba(116,210,255,.9));
  transform-origin: center;
}
#drop .body{
  fill:url(#dropGrad);
  stroke:#e6fbff; stroke-width:.8;
}

/* узлы-панели */
.node{
  position:absolute; transform: translate(-50%, -50%);
  width:320px; max-width:38vw;
}
@media (max-width:640px){ .node{width:min(88vw,360px)} }
.panel{
  background:var(--panel-bg);
  border:1px solid var(--panel-br);
  border-radius:16px; padding:14px 14px;
  backdrop-filter: blur(8px);
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
.panel .tag{
  display:inline-flex; align-items:center; gap:8px;
  background:rgba(56,189,248,.14); color:#cfefff; border:1px solid rgba(56,189,248,.28);
  padding:4px 10px; border-radius:999px; font-weight:700; letter-spacing:.03em; margin-bottom:6px;
}
.panel h3{margin:4px 0 6px 0; font-size:18px}
.panel p{margin:0; color:#dbe9f6; font-size:15px; line-height:1.5}
.panel details{margin-top:8px}
.panel summary{cursor:pointer; list-style:none; color:#cfe9f8; font-weight:600}
.panel summary::marker, .panel summary::-webkit-details-marker{display:none}
.panel .tech{
  margin-top:8px; border:1px dashed rgba(125,211,252,.35);
  border-radius:12px; padding:10px 12px; color:#d7e7f4; font-size:14px;
  background:rgba(125,211,252,.06);
}

/* декоративные 3D-иллюстрации узлов (минималные, лёгкие) */
.illus{height:68px;margin-bottom:8px;display:flex;align-items:center;justify-content:center}
.illus .cyl{
  width:66px;height:40px;border-radius:28px/16px;
  background: linear-gradient(180deg, #dfe5ea, #a8b5c5 60%, #7f8ca0);
  box-shadow: inset 0 2px 8px rgba(0,0,0,.25), 0 6px 14px rgba(0,0,0,.25);
}
.illus .pump{
  width:60px;height:36px;border-radius:8px;
  background: linear-gradient(180deg, #b7c7d8, #7f8ea5);
  box-shadow: inset 0 2px 8px rgba(0,0,0,.25), 0 6px 14px rgba(0,0,0,.25);
  position:relative;
}
.illus .pump::after{
  content:""; position:absolute; right:-14px; top:8px; width:14px; height:20px; border-radius:6px;
  background: linear-gradient(180deg, #e2edf6, #94a7bc);
}

/* финальная секция: кран → стакан */
.final{
  position:absolute; left:50%; transform:translateX(-50%); bottom:60px; width:min(520px,80vw);
  text-align:center;
}
.faucet{
  width:68px;height:52px;margin:0 auto 10px;
  background:linear-gradient(180deg,#dbe6f0,#9fb0c4);
  border-radius:10px 10px 6px 6px; position:relative; box-shadow: inset 0 2px 8px rgba(0,0,0,.25);
}
.faucet::after{ /* излив */
  content:""; position:absolute; right:-22px; top:10px; width:22px;height:16px;border-radius:0 10px 10px 0;
  background:linear-gradient(180deg,#dbe6f0,#9fb0c4);
}
.glass{
  width:52px;height:74px;border-radius:8px; margin:10px auto 0;
  border:2px solid rgba(200,230,255,.7);
  background:linear-gradient(180deg, rgba(160,230,255,.10), rgba(160,230,255,.16));
  position:relative; overflow:hidden;
}
.fill{
  position:absolute; left:0; right:0; bottom:0; height:0%;
  background:linear-gradient(180deg, rgba(116,210,255,.5), rgba(116,210,255,.9));
  transition:height .6s ease;
}
.taste{
  position:absolute; inset:-30px; border-radius:16px; pointer-events:none; opacity:0;
  background:radial-gradient(60px 30px at 50% 60%, rgba(124,249,210,.35), rgba(117,210,255,.00) 60%),
             radial-gradient(40px 24px at 30% 50%, rgba(181,255,122,.30), rgba(117,210,255,.00) 60%),
             radial-gradient(40px 24px at 70% 40%, rgba(181,255,122,.20), rgba(117,210,255,.00) 60%);
  filter: blur(10px);
  transition: opacity .8s ease;
}

/* появление панелей по мере скролла */
.reveal{opacity:0; transform:translateY(20px); transition: .5s ease}
.reveal.show{opacity:1; transform:none}

/* для зигзагов на телефоне — просто ужимаем, панельки сами встанут рядом */
@media (max-width:768px){
  .panel h3{font-size:17px}
}

/* подсказка «проламываем секции» — просто эстетика */
.section-break{height:160px}

/* убираем подчеркивание ссылок */
a{text-decoration:none}
</style>
</head>
<body class="no-video">

<!-- Фон (как на главной) -->
<video id="bgVideo" class="bg-video" autoplay muted loop playsinline preload="auto" poster="images/hero-water.jpg">
  <source src="images/water-bg.mp4" type="video/mp4" />
</video>
<div class="overlay"></div>

<header class="site-header">
  <a class="brand" href="index.html" aria-label="На главную">FS</a>
  <nav class="top-nav" aria-label="Основное меню">
    <a href="technologies.html" class="active">Технологии</a>
    <a href="sanpin.html">СанПиН</a>
    <a href="taste.html">Почему вода вкусная</a>
    <a href="services.html">Услуги</a>
    <a href="contacts.html">Контакты</a>
  </nav>
  <button class="menu-toggle" id="menuBtn" aria-label="Меню" aria-expanded="false"><span></span></button>
</header>
<nav class="mobile-drawer" id="drawer" hidden aria-label="Мобильное меню">
  <a href="technologies.html" class="active">Технологии</a>
  <a href="sanpin.html">СанПиН</a>
  <a href="taste.html">Почему вода вкусная</a>
  <a href="services.html">Услуги</a>
  <a href="contacts.html">Контакты</a>
</nav>

<section class="pipe-page">
  <div class="container-narrow">
    <h1 class="h1">Путь воды: от ХВС до стакана</h1>
    <p class="sub">Скроль вниз — **капля** двигается по «стеклянной трубе», заходя в каждый узел системы. Нажимай на стадии в мини-карте, чтобы прыгать по процессу.</p>
    <button class="btn ghost toc-toggle" id="tocBtn">Список стадий</button>
  </div>

  <div class="container-narrow pipe-grid">
    <!-- мини-карта слева -->
    <aside class="toc" id="tocDesk">
      <h3>Стадии</h3>
      <nav id="tocNav">
        <!-- генерится скриптом -->
      </nav>
      <div class="hint">Подсветка следует за каплей</div>
    </aside>

    <!-- шторка для мобилы -->
    <div class="toc-sheet" id="tocSheet">
      <div class="toc" style="position:static">
        <h3>Стадии</h3><nav id="tocNavMobile"></nav>
      </div>
    </div>

    <!-- сцена -->
    <div class="scene-wrap">

      <!-- SVG со зигзагом трубы -->
      <svg class="svg-scene" id="scene" viewBox="0 0 1200 4200" preserveAspectRatio="xMidYMin slice" aria-label="Трасса трубы">
        <defs>
          <linearGradient id="coreGrad" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%"  stop-color="rgba(200,255,255,.95)"/>
            <stop offset="70%" stop-color="rgba(116,210,255,.65)"/>
            <stop offset="100%" stop-color="rgba(116,210,255,.40)"/>
          </linearGradient>
          <radialGradient id="dropGrad" cx="50%" cy="35%" r="70%">
            <stop offset="0%" stop-color="#ffffff"/>
            <stop offset="60%" stop-color="#cfffff"/>
            <stop offset="100%" stop-color="#7dd3fc"/>
          </radialGradient>
          <!-- лёгкая тень под панелью -->
          <filter id="softShadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="10" stdDeviation="10" flood-color="#000" flood-opacity=".35"/>
          </filter>
        </defs>

        <!-- Зигзаг: ширина 1200, «петли» вправо/влево -->
        <path id="pipePath" d="
          M 160 120
          C 460 120, 740 120, 1040 220
          S 740 420, 420 520
          S 100 740, 420 900
          S 980 1080, 820 1280
          S 260 1460, 500 1680
          S 1080 1840, 960 2100
          S 360 2320, 680 2520
          S 1100 2760, 600 2960
          S 180 3200, 520 3380
          S 980 3560, 740 3740
          S 400 3920, 600 4060
        "/>

        <!-- «Сердцевина» стекла (даёт глубину) -->
        <path id="pipeCore" d="
          M 160 120
          C 460 120, 740 120, 1040 220
          S 740 420, 420 520
          S 100 740, 420 900
          S 980 1080, 820 1280
          S 260 1460, 500 1680
          S 1080 1840, 960 2100
          S 360 2320, 680 2520
          S 1100 2760, 600 2960
          S 180 3200, 520 3380
          S 980 3560, 740 3740
          S 400 3920, 600 4060
        "/>

        <!-- Капля, позиция обновляется скриптом -->
        <g id="drop" transform="translate(160,120)">
          <ellipse class="body" cx="0" cy="0" rx="12" ry="16"/>
          <circle cx="2" cy="-6" r="3" fill="#fff" opacity=".85"/>
        </g>

      </svg>

      <!-- Панели-узлы. Скрипт позиционирует их по длине пути -->
      <div id="nodes">
        <!-- шаблоны создаёт JS из конфигурации -->
      </div>

      <!-- финал: кран → стакан -->
      <div class="final" id="final">
        <div class="faucet"></div>
        <div class="glass">
          <div class="fill" id="fill"></div>
          <div class="taste" id="taste"></div>
        </div>
      </div>

    </div>
  </div>
</
